System.register(["./chunk-vendor.js","./chunk-frameworks.js","./chunk-input-demux.js","./chunk-ref-selector.js"],(function(){"use strict";var t,e,o,s,r,n,a,i,c,d,l;return{setters:[function(n){t=n.a,e=n.r,o=n.o,s=n.t,r=n.c},function(t){n=t.r,a=t.aG,i=t.aF,c=t.y,d=t.g,l=t.e},function(){},function(){}],execute:function(){var u=Object.defineProperty,h=(t,e)=>u(t,"name",{value:e,configurable:!0});t("click",".js-codespaces-update-skus-url",(t=>{const e=t.currentTarget;if(!e)return;const o=e.getAttribute("data-refname");if(document.querySelector("form.js-prefetch-codespace-location")&&o){const t=document.querySelector("[data-codespace-skus-url]"),e=t?t.getAttribute("data-codespace-skus-url"):"";if(e){const s=new URL(e,window.location.origin);s.searchParams.set("ref_name",o),t&&t.setAttribute("data-codespace-skus-url",s.toString()),t&&t.setAttribute("data-branch-has-changed","true")}}})),t("remote-input-error","#js-codespaces-repository-select",(()=>{document.querySelector("#js-codespaces-unable-load-repositories-warning").hidden=!1})),e(".js-new-codespace-form",(async function(t,e){const o=t.closest("[data-replace-remote-form-target]"),s=o.querySelector(".js-new-codespace-submit-button");s instanceof HTMLInputElement&&(s.disabled=!0),t.classList.remove("is-error"),t.classList.add("is-loading");try{const t=await e.html();o.replaceWith(t.html)}catch(e){t.classList.remove("is-loading"),t.classList.add("is-error")}}));let p=null;function m(t){p=t,null!==t&&document.querySelector(".js-codespace-loading-steps").setAttribute("data-current-state",p)}h(m,"advanceLoadingState"),o(".js-codespace-loading-steps",{constructor:HTMLElement,add:t=>{const e=t.getAttribute("data-current-state");e&&m(e)}}),o(".js-codespace-advance-state",{constructor:HTMLElement,add:t=>{const e=t.getAttribute("data-state");e&&m(e)}});let f=null;function g(t){e(".js-fetch-cascade-token",(async function(t,e){try{f=(await e.json()).json.token}catch(t){}})),n(t)}function y(t,e,o){if(document.querySelector(t)){const t=Date.now(),s=setInterval(h((()=>{const r=Date.now()-t;if(f||r>=o)return clearInterval(s),void e(f||void 0)}),"checkToken"),50)}}function b(t,e){if(""!==e.value){const e=t.querySelector("form");n(e)}else g(document.querySelector(".js-fetch-cascade-token")),y(".js-workbench-form-container",k,1e4)}function k(t){const e=document.querySelector(".js-workbench-form-container form");e&&t?(v(e,t),w(e,t),n(e)):m("failed")}function v(t,e){const o=t.querySelector(".js-cascade-token");o&&o.setAttribute("value",e)}function w(t,e){const o=t.querySelector(".js-partner-info");if(o){let t=o.getAttribute("value");t&&(t=t.replace("%CASCADE_TOKEN_PLACEHOLDER%",e),o.setAttribute("value",t))}}h(g,"fetchCascadeToken"),h(y,"waitForCascadeTokenWithTimeout"),o(".js-auto-submit-form",{constructor:HTMLFormElement,initialize:n}),o(".js-workbench-form-container",{constructor:HTMLElement,add:t=>{const e=t.querySelector(".js-cascade-token");b(t,e)}}),h(b,"resolveCascadeToken"),h(k,"insertCodespaceTokenIntoShowAuthForm"),h(v,"insertCodespaceTokenIntoCascadeField"),h(w,"insertCodespaceTokenIntoPartnerInfo");var S=Object.defineProperty,j=Object.getOwnPropertyDescriptor,L=(t,e,o,s)=>{for(var r,n=s>1?void 0:s?j(e,o):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,o,n):r(n))||n);return s&&n&&S(e,o,n),n};let A=class extends HTMLElement{async connectedCallback(){if(this.createCodespaceForm){const t=await a(this.createCodespaceForm,!this.vscsLocationList);this.updatePickableLocations(t)}}toggleLoadingVscode(){const t=this.loadingVscode.hidden,e=this.children;for(let o=0;o<e.length;o++)e[o].hidden=t;this.loadingVscode.hidden=!t}pollForVscode(t){this.toggleLoadingVscode();const e=t.currentTarget.getAttribute("data-src");e&&this.vscodePoller.setAttribute("src",e)}async updatePickableLocations(t){if(!t){const e=this.createCodespaceForm.getAttribute("data-codespace-locations-url");if(!e)return;t=await i(e)}const e=t.available;if(this.vscsLocationList){const o=this.vscsLocationList.querySelectorAll(".SelectMenu-item");for(const t of o)e.includes(t.getAttribute("data-location"))?t.removeAttribute("hidden"):t.setAttribute("hidden","hidden");const s=this.createCodespaceForm.querySelector('[name="codespace[location]"]');if(s&&!e.includes(s.value)){s.value=t.current,this.vscsLocationSummary.textContent=this.vscsLocationSummary.getAttribute("data-blank-title");for(const t of o)t.setAttribute("aria-checked","false")}}}vscsTargetUrlUpdated(t){const e=t.currentTarget;this.vscsTargetUrl.value=e.value}};S(A,"name",{value:"NewCodespaceElement",configurable:!0}),L([s],A.prototype,"form",2),L([s],A.prototype,"createCodespaceForm",2),L([s],A.prototype,"createCodespaceWithSkuSelectForm",2),L([s],A.prototype,"vscsTargetUrl",2),L([s],A.prototype,"vscsLocationList",2),L([s],A.prototype,"vscsLocationSummary",2),L([s],A.prototype,"loadingVscode",2),L([s],A.prototype,"vscodePoller",2),A=L([r],A);var C=Object.defineProperty,E=(t,e)=>C(t,"name",{value:e,configurable:!0});function P(t){const e=t.querySelectorAll(".js-toggle-hidden");for(const t of e)t.hidden=!t.hidden;const o=t.querySelectorAll(".js-toggle-disabled");for(const t of o)t.getAttribute("aria-disabled")?t.removeAttribute("aria-disabled"):t.setAttribute("aria-disabled","true")}function T(t){return t.closest("[data-replace-remote-form-target]")}async function q(){const t=document.querySelector(".js-codespaces-details-container");t&&(t.open=!1);const e=document.querySelector("new-codespace");if(e)try{const t=await fetch("/codespaces/new");if(t&&t.ok){const o=c(document,await t.text());e.replaceWith(o)}}catch(t){}}async function D(t,e){const o=document.querySelector(`#${t}`),s=await d({content:o.content.cloneNode(!0),dialogClass:"project-dialog"});return e&&e.setAttribute("aria-expanded","true"),s.addEventListener("dialog:remove",(function(){e&&P(e)}),{once:!0}),s}async function F(t){const e=await fetch(t.action,{method:t.method,body:new FormData(t),headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(e.ok){const o=await e.json();o.codespace_url?(window.location.href=o.codespace_url,P(t),q()):(t.closest("get-repo")||t.closest("new-codespace")?(t.setAttribute("data-src",o.loading_url),t.dispatchEvent(new CustomEvent("pollvscode"))):t.closest("prefetch-pane")&&(t.setAttribute("data-src",o.loading_url),t.dispatchEvent(new CustomEvent("prpollvscode"))),P(t))}else 422===e.status&&await D("concurrency-error",t)}t("submit",".js-toggle-hidden-codespace-form",(function(t){P(t.currentTarget)})),t("click",".js-create-codespace-with-sku-button",(async function(t){const e=t.currentTarget,o=e.closest("[data-target*='new-codespace.createCodespaceForm']")||e.closest("[data-target*='new-codespace.createCodespaceWithSkuSelectForm']");await a(o),o.classList.contains("js-open-in-vscode-form")?(P(o),F(o)):(o.submit(),q())})),E(P,"toggleFormSubmissionInFlight"),E(T,"getFormTarget"),E(q,"createFormSubmitted"),t("submit",".js-create-codespaces-form-command",(function(t){const e=t.currentTarget;e.classList.contains("js-open-in-vscode-form")||(q(),P(e))})),t("submit","form.js-codespaces-delete-form",(async function(t){t.preventDefault();const e=t.currentTarget;try{const t=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{Accept:"text/fragment+html","X-Requested-With":"XMLHttpRequest"}});if(t.ok){const o=c(document,await t.text());T(e).replaceWith(o)}else{if(401!==t.status)throw new Error(`Unexpected response: ${t.statusText}`);e.submit()}}finally{P(e)}})),t("submit","form.js-open-in-vscode-form",(async function(t){t.preventDefault();const e=t.currentTarget;await F(e)})),E(D,"openDialog"),E(F,"createCodespaceIntoVscode");var x=Object.defineProperty,M=Object.getOwnPropertyDescriptor,B=(t,e,o,s)=>{for(var r,n=s>1?void 0:s?M(e,o):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,o,n):r(n))||n);return s&&n&&x(e,o,n),n};let O=class extends HTMLElement{constructor(){super(...arguments),this.abortPoll=null}connectedCallback(){this.abortPoll=new AbortController,this.loadingIndicator.hidden||this.startPoll()}disconnectedCallback(){var t;null==(t=this.abortPoll)||t.abort()}async exportBranch(t){t.preventDefault(),this.form.hidden=!0,this.loadingIndicator.hidden=!1,(await fetch(this.form.action,{method:this.form.method,body:new FormData(this.form),headers:{Accept:"text/fragment+html","X-Requested-With":"XMLHttpRequest"}})).ok?this.startPoll():(this.form.hidden=!1,this.loadingIndicator.hidden=!0)}async startPoll(){const t=this.getAttribute("data-exported-codespace-url")||"",e=await this.poll(t);if(e)if(e.ok)this.loadingIndicator.hidden=!0,this.viewBranchLink.hidden=!1;else{const t=this.getAttribute("data-export-error-redirect-url")||"";window.location.href=t}}async poll(t,e=1e3){var o,s;if(null==(o=this.abortPoll)?void 0:o.signal.aborted)return;const r=await fetch(t,{signal:null==(s=this.abortPoll)?void 0:s.signal});return 202===r.status?(await new Promise((t=>setTimeout(t,e))),this.poll(t,1.5*e)):r}};x(O,"name",{value:"ExportBranchElement",configurable:!0}),B([s],O.prototype,"form",2),B([s],O.prototype,"loadingIndicator",2),B([s],O.prototype,"viewBranchLink",2),O=B([r],O);var H=Object.defineProperty,R=Object.getOwnPropertyDescriptor,V=(t,e,o,s)=>{for(var r,n=s>1?void 0:s?R(e,o):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,o,n):r(n))||n);return s&&n&&H(e,o,n),n};let I=class extends HTMLElement{reset(t){for(t.preventDefault(),this.dropdownDetails.hidden=!1,this.modalDetails.hidden=!0,this.exportDetails.hidden=!0,this.skuForm.hidden=!1;this.resultMessage.firstChild;)this.resultMessage.removeChild(this.resultMessage.firstChild);this.resultMessage.hidden=!0,this.errorMessage.hidden=!0}showSettingsModal(){this.dropdownDetails.hidden=!0,this.modalDetails.open=!0,this.modalDetails.hidden=!1,this.dynamicSkus&&this.dynamicSkus.setAttribute("src",this.dynamicSkus.getAttribute("data-src"))}showExportModal(){this.dropdownDetails.hidden=!0,this.exportDetails.open=!0,this.exportDetails.hidden=!1,this.insertBranchExportComponent()}async updateSku(){P(this.skuForm);try{const t=await fetch(this.skuForm.action,{method:this.skuForm.method,body:new FormData(this.skuForm),headers:{Accept:"text/fragment+html","X-Requested-With":"XMLHttpRequest"}});if(t.ok){const e=c(document,await t.text());this.resultMessage.appendChild(e),this.skuForm.hidden=!0,this.resultMessage.hidden=!1}else this.errorMessage.hidden=!1,this.skuForm.hidden=!0}finally{P(this.skuForm)}}async insertBranchExportComponent(){const t=this.querySelector("[data-branch-export-url]");if(!t)return;const e=t.getAttribute("data-branch-export-url");if(!e)return;const o=await l(document,e);!o||(t.innerHTML="",t.appendChild(o))}};((t,e)=>{H(t,"name",{value:"OptionsPopoverElement",configurable:!0})})(I),V([s],I.prototype,"dropdownDetails",2),V([s],I.prototype,"modalDetails",2),V([s],I.prototype,"settingsModal",2),V([s],I.prototype,"skuForm",2),V([s],I.prototype,"resultMessage",2),V([s],I.prototype,"errorMessage",2),V([s],I.prototype,"exportDetails",2),V([s],I.prototype,"dynamicSkus",2),I=V([r],I);var W=Object.defineProperty,X=Object.getOwnPropertyDescriptor,_=(t,e,o,s)=>{for(var r,n=s>1?void 0:s?X(e,o):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,o,n):r(n))||n);return s&&n&&W(e,o,n),n};let U=class extends HTMLElement{constructor(){super(...arguments),this.prefetching=!1,this.remainingRetries=3}async connectedCallback(){this.openSkuButton&&this.skipSkuButton?this.prefetchLocationAndSkus():this.showOpenSkuButton()}async prefetchLocationAndSkus(){const t="true"===this.getAttribute("data-branch-has-changed");if(this.prefetching&&!t)return;const e=document.querySelector("form.js-prefetch-codespace-location")||document.querySelector("form.js-open-in-vscode-form")||document.querySelector("form.js-open-in-web-form");if(e){this.prefetching=!0;const t=await a(e);if(t&&(this.currentLocation=t.current),!this.skuSelect)return;const o=this.getAttribute("data-codespace-skus-url");if(this.currentLocation&&o){const t=await fetch(`${o}&location=${this.currentLocation}`,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/html_fragment"}});if(t.ok){this.setAttribute("data-branch-has-changed","false");const e=c(document,await t.text()),o=Array.from(e.querySelectorAll("input[name='codespace[sku_name]']")).filter((t=>!t.disabled));1===o.length?(o[0].select(),this.showSkipSkuButton()):this.showOpenSkuButton(),this.skuSelect.replaceWith(e),this.skuSelect.hidden=!1,this.skuError&&(this.skuError.hidden=!0)}else this.showOpenSkuButton(),this.remainingRetries-=1,this.remainingRetries>0&&(this.prefetching=!1),this.skuSelect.hidden=!0,this.skuError&&(this.skuError.hidden=!1)}}}showOpenSkuButton(){var t;void 0===this.shownButton&&this.openSkuButton&&(this.shownButton=this.openSkuButton,this.shownButton.hidden=!1,null==(t=this.skipSkuButton)||t.remove())}showSkipSkuButton(){var t,e;if(void 0===this.shownButton&&this.skipSkuButton){this.shownButton=this.skipSkuButton,this.shownButton.hidden=!1;const o=null==(t=this.openSkuButton)?void 0:t.parentElement;o&&o instanceof HTMLDetailsElement&&(o.hidden=!0),null==(e=this.openSkuButton)||e.remove()}}toggleLoadingVscode(){if(this.loadingVscode){const t=this.loadingVscode.hidden,e=this.children;for(let o=0;o<e.length;o++)e[o].hidden=t;this.loadingVscode.hidden=!t}}pollForVscode(t){if(this.vscodePoller){this.toggleLoadingVscode();const e=t.currentTarget.getAttribute("data-src");e&&this.vscodePoller.setAttribute("src",e)}}};((t,e)=>{W(t,"name",{value:"PrefetchPaneElement",configurable:!0})})(U),_([s],U.prototype,"skuSelect",2),_([s],U.prototype,"skuError",2),_([s],U.prototype,"loadingVscode",2),_([s],U.prototype,"vscodePoller",2),_([s],U.prototype,"openSkuButton",2),_([s],U.prototype,"skipSkuButton",2),U=_([r],U);var $=Object.defineProperty,N=Object.getOwnPropertyDescriptor,z=(t,e,o,s)=>{for(var r,n=s>1?void 0:s?N(e,o):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,o,n):r(n))||n);return s&&n&&$(e,o,n),n};let G=class extends HTMLElement{async connectedCallback(){this.closeDetailsPopover();const t=this.getAttribute("data-codespace-url");t&&(window.location.href=t)}closeDetailsPopover(){const t=document.querySelector(".js-codespaces-details-container");t&&(t.open=!1)}};((t,e)=>{$(t,"name",{value:"VscodeForwarderElement",configurable:!0})})(G),z([s],G.prototype,"vscodeLink",2),G=z([r],G)}}}));